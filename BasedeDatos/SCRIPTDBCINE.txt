CREATE DATABASE cine;
USE cine;

CREATE TABLE rol (
	id_rol INT IDENTITY(1,1) PRIMARY KEY,
	nombre_rol NVARCHAR(44) NOT NULL UNIQUE
);

INSERT INTO rol (nombre_rol) VALUES ('Administrador');
INSERT INTO rol (nombre_rol) VALUES ('Usuario')

CREATE TABLE usuario (
    id_usuario INT IDENTITY(1,1) PRIMARY KEY,
    nombre NVARCHAR(50) NOT NULL,
    contrasena NVARCHAR(255) NOT NULL,
    correo NVARCHAR(100) NOT NULL UNIQUE,
    id_rol INT NOT NULL FOREIGN KEY REFERENCES rol(id_rol)
);

INSERT INTO usuario (nombre, contrasena, correo, id_rol) 
VALUES ('Administrador', 'admin123', 'admin@prueba.com', 1);

CREATE TABLE pelicula (
    id_pelicula INT PRIMARY KEY IDENTITY(1,1),
    titulo NVARCHAR(150) NOT NULL,
    descripcion NVARCHAR(MAX),
    duracion INT,
    genero NVARCHAR(50),
    fecha_estreno DATE,
    director NVARCHAR(100),
    reparto NVARCHAR(300)              
);

CREATE TABLE sala (
    id_sala INT PRIMARY KEY IDENTITY(1,1),
    nombre NVARCHAR(50) NOT NULL,
    capacidad INT NOT NULL,
    filas INT NOT NULL,
    columnas INT NOT NULL,
    tipo NVARCHAR(30),
    estado BIT NOT NULL DEFAULT 1
);

CREATE TABLE funcion (
    id_funcion INT PRIMARY KEY IDENTITY(1,1),	
    descripcion NVARCHAR(50),
    id_pelicula INT NOT NULL FOREIGN KEY REFERENCES pelicula(id_pelicula),
    id_sala INT NOT NULL FOREIGN KEY REFERENCES sala(id_sala),
    fecha DATE NOT NULL,
    hora NVARCHAR(10) NOT NULL
);
